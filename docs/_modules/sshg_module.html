
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>sshg_module &#8212; Alpaga 1.2 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for sshg_module</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>

<span class="c1"># Alpaga</span>
<span class="c1"># AnaLyse en PolArisation de la Generation de second hArmonique </span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">curve_fit</span>

<span class="c1">############################################################################################</span>
<span class="c1">############################################################################################</span>
<span class="c1">############################################################################################</span>

<span class="c1">#ai calculation (biblio these Aurelie Bruyere p70 à 81)</span>

<span class="k">def</span> <span class="nf">r_s</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span><span class="n">n2</span><span class="p">,</span><span class="n">angle_1</span><span class="p">,</span><span class="n">angle_2</span><span class="p">):</span> <span class="c1">#Fresnel coeff for a sagittal reflected wave</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">n1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle_1</span><span class="p">)</span> <span class="o">-</span> <span class="n">n2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle_2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">n1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle_1</span><span class="p">)</span> <span class="o">+</span> <span class="n">n2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle_2</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">r_p</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span><span class="n">n2</span><span class="p">,</span><span class="n">angle_1</span><span class="p">,</span><span class="n">angle_2</span><span class="p">):</span> <span class="c1">#Fresnel coeff for a parallel reflected wave</span>
    <span class="k">return</span> <span class="o">-</span><span class="p">(</span><span class="n">n2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle_1</span><span class="p">)</span> <span class="o">-</span> <span class="n">n1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle_2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">n1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle_2</span><span class="p">)</span> <span class="o">+</span> <span class="n">n2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle_1</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">t_s</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span><span class="n">n2</span><span class="p">,</span><span class="n">angle_1</span><span class="p">,</span><span class="n">angle_2</span><span class="p">):</span> <span class="c1">#Fresnel coeff for a sagittal transmited wave</span>
    <span class="k">return</span> <span class="mi">2</span><span class="o">*</span><span class="n">n1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle_1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">n1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle_1</span><span class="p">)</span> <span class="o">+</span> <span class="n">n2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle_2</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">t_p</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span><span class="n">n2</span><span class="p">,</span><span class="n">angle_1</span><span class="p">,</span><span class="n">angle_2</span><span class="p">):</span> <span class="c1">#Fresnel coeff for a parallel transmited wave</span>
    <span class="k">return</span> <span class="mi">2</span><span class="o">*</span><span class="n">n1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle_1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">n2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle_1</span><span class="p">)</span> <span class="o">+</span> <span class="n">n1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle_2</span><span class="p">))</span>

<span class="c1">############################################################################################</span>
<span class="c1">############################################################################################</span>
<span class="c1">############################################################################################</span>

<span class="c1"># Calcul des coeff de fresnel &quot;modifié&quot; (ai) par le modèle de la feuille de polarisation</span>
<div class="viewcode-block" id="ai_coeff"><a class="viewcode-back" href="../analysis_SSHG.html#sshg_module.ai_coeff">[docs]</a><span class="k">def</span> <span class="nf">ai_coeff</span><span class="p">(</span><span class="n">angle1</span><span class="p">,</span><span class="n">n1</span><span class="p">,</span><span class="n">n2</span><span class="p">,</span><span class="n">N1</span><span class="p">,</span><span class="n">N2</span><span class="p">):</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    From experimental angle of incidence and refractive index values of materials for fundamental and harmonic wavelength, </span>
<span class="sd">    this function return ai coefficients and the angle of the harmonic reflected wave. \\</span>
<span class="sd">    You can see Aurèlie Bruyere Thesis, p70 to 81, for details of the calculation.</span>
<span class="sd">     </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    </span>
<span class="sd">    angle1 : float</span>
<span class="sd">        experimental angle of incidence</span>
<span class="sd">    n1 : float</span>
<span class="sd">        refractive index of medium 1 for fundamental wavelength</span>
<span class="sd">    n2 : float</span>
<span class="sd">        refractive index of medium 2 for fundamental wavelength</span>
<span class="sd">    N1 : float</span>
<span class="sd">        refractive index of medium 1 for harmonic wavelength</span>
<span class="sd">    N2 : float</span>
<span class="sd">        refractive index of medium 2 for harmonic wavelength</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    </span>
<span class="sd">    ai : list </span>
<span class="sd">        It contains value of ai coefficients and the angle of the harmonic reflected wave. \\</span>
<span class="sd">        Structure of the list : \\</span>
<span class="sd">        </span>
<span class="sd">        [a1,</span>
<span class="sd">        a2,</span>
<span class="sd">        a3,</span>
<span class="sd">        a4,</span>
<span class="sd">        a5,</span>
<span class="sd">        reflected angle of reflected wave]</span>
<span class="sd">    </span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">nm</span><span class="o">=</span><span class="p">(</span><span class="n">n1</span><span class="o">+</span><span class="n">n2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="c1">#refractive index mean value between medium 1 and 2 for fundamental wave</span>
    <span class="n">Nm</span><span class="o">=</span><span class="p">(</span><span class="n">N1</span><span class="o">+</span><span class="n">N2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="c1">#refractive index mean value between medium 1 and 2 for harmonic wave</span>
    
    <span class="n">angle_1</span><span class="o">=</span><span class="n">angle1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span>
    
    <span class="n">arg_angle_m</span> <span class="o">=</span> <span class="n">n1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angle_1</span><span class="p">)</span><span class="o">/</span><span class="n">nm</span>
    <span class="n">arg_angle_2</span> <span class="o">=</span> <span class="n">n1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angle_1</span><span class="p">)</span><span class="o">/</span><span class="n">n2</span>
    
    <span class="k">if</span> <span class="n">arg_angle_m</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">or</span> <span class="n">arg_angle_m</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">arg_angle_2</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">or</span> <span class="n">arg_angle_2</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Total reflection condition&quot;</span><span class="p">)</span>
    
    <span class="n">angle_m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="n">n1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angle_1</span><span class="p">)</span><span class="o">/</span> <span class="n">nm</span><span class="p">)</span>
    <span class="n">angle_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="n">n1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angle_1</span><span class="p">)</span><span class="o">/</span> <span class="n">n2</span><span class="p">)</span>
    
    <span class="n">arg_ANGLE_M</span> <span class="o">=</span> <span class="n">nm</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angle_m</span><span class="p">)</span><span class="o">/</span><span class="n">Nm</span>
    
    <span class="k">if</span> <span class="n">arg_ANGLE_M</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">or</span> <span class="n">arg_ANGLE_M</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Total reflection condition&quot;</span><span class="p">)</span>  
    
    <span class="n">ANGLE_M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="n">nm</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angle_m</span><span class="p">)</span><span class="o">/</span><span class="n">Nm</span><span class="p">)</span>
    
    <span class="n">arg_ANGLE_1</span> <span class="o">=</span> <span class="n">Nm</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">ANGLE_M</span><span class="p">)</span><span class="o">/</span><span class="n">N1</span>
    <span class="n">arg_ANGLE_2</span> <span class="o">=</span> <span class="n">Nm</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">ANGLE_M</span><span class="p">)</span><span class="o">/</span><span class="n">N2</span>
    
    <span class="k">if</span> <span class="n">arg_ANGLE_1</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">or</span> <span class="n">arg_ANGLE_1</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">arg_ANGLE_2</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">or</span> <span class="n">arg_ANGLE_2</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Total reflection condition&quot;</span><span class="p">)</span>
    
    <span class="n">ANGLE_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="n">Nm</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">ANGLE_M</span><span class="p">)</span><span class="o">/</span><span class="n">N1</span><span class="p">)</span>
    <span class="n">ANGLE_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="n">Nm</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">ANGLE_M</span><span class="p">)</span><span class="o">/</span><span class="n">N2</span><span class="p">)</span>
    
    <span class="n">e_x</span> <span class="o">=</span> <span class="n">t_p</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span><span class="n">nm</span><span class="p">,</span><span class="n">angle_1</span><span class="p">,</span><span class="n">angle_m</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">r_p</span><span class="p">(</span><span class="n">nm</span><span class="p">,</span><span class="n">n2</span><span class="p">,</span><span class="n">angle_m</span><span class="p">,</span><span class="n">angle_2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle_m</span><span class="p">)</span>
    <span class="n">e_y</span> <span class="o">=</span> <span class="n">t_s</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span><span class="n">nm</span><span class="p">,</span><span class="n">angle_1</span><span class="p">,</span><span class="n">angle_m</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">r_s</span><span class="p">(</span><span class="n">nm</span><span class="p">,</span><span class="n">n2</span><span class="p">,</span><span class="n">angle_m</span><span class="p">,</span><span class="n">angle_2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">e_z</span> <span class="o">=</span> <span class="n">t_p</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span><span class="n">nm</span><span class="p">,</span><span class="n">angle_1</span><span class="p">,</span><span class="n">angle_m</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">r_p</span><span class="p">(</span><span class="n">nm</span><span class="p">,</span><span class="n">n2</span><span class="p">,</span><span class="n">angle_m</span><span class="p">,</span><span class="n">angle_2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angle_m</span><span class="p">)</span>

    <span class="n">E_x</span> <span class="o">=</span> <span class="n">t_p</span><span class="p">(</span><span class="n">Nm</span><span class="p">,</span><span class="n">N1</span><span class="p">,</span><span class="n">ANGLE_M</span><span class="p">,</span><span class="n">ANGLE_1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">r_p</span><span class="p">(</span><span class="n">Nm</span><span class="p">,</span><span class="n">N2</span><span class="p">,</span><span class="n">ANGLE_M</span><span class="p">,</span><span class="n">ANGLE_2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">ANGLE_M</span><span class="p">)</span>
    <span class="n">E_y</span> <span class="o">=</span> <span class="n">t_s</span><span class="p">(</span><span class="n">Nm</span><span class="p">,</span><span class="n">N1</span><span class="p">,</span><span class="n">ANGLE_M</span><span class="p">,</span><span class="n">ANGLE_1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">r_s</span><span class="p">(</span><span class="n">Nm</span><span class="p">,</span><span class="n">N2</span><span class="p">,</span><span class="n">ANGLE_M</span><span class="p">,</span><span class="n">ANGLE_2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">E_z</span> <span class="o">=</span> <span class="n">t_p</span><span class="p">(</span><span class="n">Nm</span><span class="p">,</span><span class="n">N1</span><span class="p">,</span><span class="n">ANGLE_M</span><span class="p">,</span><span class="n">ANGLE_1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">r_p</span><span class="p">(</span><span class="n">Nm</span><span class="p">,</span><span class="n">N2</span><span class="p">,</span><span class="n">ANGLE_M</span><span class="p">,</span><span class="n">ANGLE_2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">ANGLE_M</span><span class="p">)</span>

    <span class="n">a1</span> <span class="o">=</span> <span class="n">e_y</span> <span class="o">*</span> <span class="n">e_z</span> <span class="o">*</span> <span class="n">E_y</span>
    <span class="n">a2</span> <span class="o">=</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">e_x</span> <span class="o">*</span> <span class="n">e_z</span> <span class="o">*</span> <span class="n">E_x</span>
    <span class="n">a3</span> <span class="o">=</span> <span class="n">e_x</span> <span class="o">*</span> <span class="n">e_x</span> <span class="o">*</span> <span class="n">E_z</span>
    <span class="n">a4</span> <span class="o">=</span> <span class="n">e_z</span> <span class="o">*</span> <span class="n">e_z</span> <span class="o">*</span> <span class="n">E_z</span>
    <span class="n">a5</span> <span class="o">=</span> <span class="n">e_y</span> <span class="o">*</span> <span class="n">e_y</span> <span class="o">*</span> <span class="n">E_z</span>
    
    <span class="k">return</span> <span class="p">[</span><span class="n">a1</span><span class="p">,</span><span class="n">a2</span><span class="p">,</span><span class="n">a3</span><span class="p">,</span><span class="n">a4</span><span class="p">,</span><span class="n">a5</span><span class="p">,</span><span class="n">ANGLE_1</span><span class="p">]</span></div>

<span class="c1">############################################################################################</span>
<span class="c1">############################################################################################</span>
<span class="c1">############################################################################################</span>

<span class="c1">#Definition of fiting equation for S and P polarisation</span>
<div class="viewcode-block" id="fit_polaS"><a class="viewcode-back" href="../analysis_SSHG.html#sshg_module.fit_polaS">[docs]</a><span class="k">def</span> <span class="nf">fit_polaS</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">chi_XXZ</span><span class="p">,</span> <span class="n">ai</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    It&#39;s the function that defines the theoritical equation for S polarisation.</span>
<span class="sd">   </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    </span>
<span class="sd">    x: list</span>
<span class="sd">        The polarisation angle of the fundamental in degree. The angle shall be given in degrees!</span>
<span class="sd">    chi_XXZ: float</span>
<span class="sd">        The value of chi_XXZ element</span>
<span class="sd">    ai: list</span>
<span class="sd">        List of the ai elements with the same structure as the return of *sshg_module.ai_coeff*.</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    y: list</span>
<span class="sd">        The S polarised SSHG intensity </span>
<span class="sd">    </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">X</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">ai</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">*</span><span class="n">chi_XXZ</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">y</span><span class="p">)</span></div>
    
<span class="c1">############################################################################################</span>

<div class="viewcode-block" id="fit_polaP"><a class="viewcode-back" href="../analysis_SSHG.html#sshg_module.fit_polaP">[docs]</a><span class="k">def</span> <span class="nf">fit_polaP</span><span class="p">(</span><span class="n">x</span><span class="p">,</span>  <span class="n">chi_XXZ</span><span class="p">,</span> <span class="n">chi_ZXX</span><span class="p">,</span> <span class="n">chi_ZZZ</span><span class="p">,</span> <span class="n">ai</span><span class="p">):</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    It&#39;s the function that defines the theoritical equation for P polarisation.</span>
<span class="sd">   </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    </span>
<span class="sd">    x: list</span>
<span class="sd">        The polarisation angle of the fundamental in degree. The angle shall be given in degrees!</span>
<span class="sd">    chi_XXZ: float</span>
<span class="sd">        The value of chi_XXZ element</span>
<span class="sd">    chi_ZXX: float</span>
<span class="sd">        The value of chi_ZXX element</span>
<span class="sd">    chi_ZZZ: float</span>
<span class="sd">        The value of chi_ZZZ element</span>
<span class="sd">    ai: list</span>
<span class="sd">        List of the ai elements with the same structure as the return of *sshg_module.ai_coeff*.</span>
<span class="sd">     </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    </span>
<span class="sd">    y: list</span>
<span class="sd">        The P polarised SSHG intensity </span>
<span class="sd">    </span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">y</span> <span class="o">=</span> <span class="p">((</span><span class="n">ai</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">chi_XXZ</span><span class="o">+</span><span class="n">ai</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">chi_ZXX</span><span class="o">+</span><span class="n">ai</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">chi_ZZZ</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">ai</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">chi_ZXX</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">y</span><span class="p">)</span>    </div>

<span class="c1">############################################################################################</span>

<span class="k">def</span> <span class="nf">fit_pola45</span><span class="p">(</span><span class="n">x</span><span class="p">,</span>  <span class="n">chi_XXZ</span><span class="p">,</span> <span class="n">chi_ZXX</span><span class="p">,</span> <span class="n">chi_ZZZ</span><span class="p">,</span> <span class="n">ai</span><span class="p">):</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    It&#39;s the function that defines the theoritical equation for 45° polarisation.</span>
<span class="sd">   </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    </span>
<span class="sd">    x: list</span>
<span class="sd">        The polarisation angle of the fundamental in degree. The angle shall be given in degrees!</span>
<span class="sd">    chi_XXZ: float</span>
<span class="sd">        The value of chi_XXZ element</span>
<span class="sd">    chi_ZXX: float--upgrade pip</span>
<span class="sd">        The value of chi_ZXX element</span>
<span class="sd">    chi_ZZZ: float</span>
<span class="sd">        The value of chi_ZZZ element</span>
<span class="sd">    ai: list</span>
<span class="sd">        List of the ai elements with the same structure as the return of *sshg_module.ai_coeff*.</span>
<span class="sd">     </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    </span>
<span class="sd">    y: list</span>
<span class="sd">        The 45° polarised SSHG intensity </span>
<span class="sd">    </span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">deuxX</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
    <span class="n">mix</span> <span class="o">=</span> <span class="n">ai</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">chi_XXZ</span><span class="o">+</span><span class="n">ai</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">chi_ZXX</span><span class="o">+</span><span class="n">ai</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">chi_ZZZ</span>
    <span class="n">y</span> <span class="o">=</span> <span class="p">((</span><span class="n">mix</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">ai</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">chi_ZXX</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">ai</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">deuxX</span><span class="p">)</span><span class="o">*</span><span class="n">chi_XXZ</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span> <span class="n">y</span>
    
<span class="c1">############################################################################################</span>
    
<div class="viewcode-block" id="analyse_polarization_SSHG"><a class="viewcode-back" href="../analysis_SSHG.html#sshg_module.analyse_polarization_SSHG">[docs]</a><span class="k">def</span> <span class="nf">analyse_polarization_SSHG</span><span class="p">(</span><span class="n">angle_incidence</span><span class="p">,</span> <span class="n">n1_fonda</span><span class="p">,</span> <span class="n">n2_fonda</span><span class="p">,</span> <span class="n">n1_harmo</span><span class="p">,</span> <span class="n">n2_harmo</span><span class="p">,</span> <span class="n">L_angle_deg</span><span class="p">,</span> <span class="n">L_intensity_S</span><span class="p">,</span> <span class="n">L_intensity_P</span><span class="p">,</span> <span class="n">XXZ</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="p">:</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    From experimental angle of incidence, refractive index values of materials for fundamental and harmonic wavelength, polarisation angle and the SSHG gaussian intensity, the function returns ai coefficients and chi coefficients for an isotrope achiral interface. </span>
<span class="sd">    ref : Aurèlie Bruyere Thesis, p70 to 81</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    </span>
<span class="sd">    angle1 : float</span>
<span class="sd">        experimental angle of incidence</span>
<span class="sd">    n1 : float</span>
<span class="sd">        refractive index of medium 1 for fundamntal wavelength</span>
<span class="sd">    n2 : float</span>
<span class="sd">        refractive index of medium 2 for fundamntal wavelength</span>
<span class="sd">    N1 : float</span>
<span class="sd">        refractive index of medium 1 for harmonic wavelength</span>
<span class="sd">    N2 : float</span>
<span class="sd">        refractive index of medium 2 for harmonic wavelength</span>
<span class="sd">    L_angle: list</span>
<span class="sd">        The polarisation angle of the fundamental in degree.</span>
<span class="sd">    L_intensity_S: list</span>
<span class="sd">        The SSHG intensity for S polarized analyser. The size of *L_angle* and *L_intensity_S* shall match. </span>
<span class="sd">    L_intensity_P: list</span>
<span class="sd">        The SSHG intensity for P polarized analyser. The size of *L_angle* and *L_intensity_P* shall match.</span>
<span class="sd">    XXZ: float</span>
<span class="sd">        This parameter allows you to fix the value of chi_xxz if, for exemple, your S polarisation is flat. It avoid fitting the noise and recover a non physical value for this element. By default, the value is set to &#39;False&#39; : in this case chi_xxz is extracted by the fitting of S polarisation.</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    </span>
<span class="sd">    ai : list</span>
<span class="sd">        It contains value of ai coefficients and the angle of the harmonic reflected wave. \\</span>
<span class="sd">        Structure of the list : \\</span>
<span class="sd">        </span>
<span class="sd">        [a1,</span>
<span class="sd">        a2,</span>
<span class="sd">        a3,</span>
<span class="sd">        a4,</span>
<span class="sd">        a5,</span>
<span class="sd">        reflected angle of reflected wave]</span>
<span class="sd">    </span>
<span class="sd">    list_chi : list</span>
<span class="sd">        It contains two mathematical solutions for coefficient chi. \\</span>
<span class="sd">        Structure of the list : \\</span>
<span class="sd">        </span>
<span class="sd">        [chi_XXZ,</span>
<span class="sd">        chi_ZXX,</span>
<span class="sd">        chi_ZZZ,</span>
<span class="sd">        </span>
<span class="sd">        chi_XXZset2,</span>
<span class="sd">        chi_ZXXset2,</span>
<span class="sd">        chi_ZZset2]</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">ai</span><span class="o">=</span><span class="n">ai_coeff</span><span class="p">(</span><span class="n">angle_incidence</span><span class="p">,</span><span class="n">n1_fonda</span><span class="p">,</span><span class="n">n2_fonda</span><span class="p">,</span><span class="n">n1_harmo</span><span class="p">,</span><span class="n">n2_harmo</span><span class="p">)</span>
    
    <span class="n">L_angle_rad</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">L_angle_deg</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">XXZ</span><span class="o">==</span><span class="kc">False</span><span class="p">:</span>
        <span class="k">def</span> <span class="nf">helper_S</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">chi_XXZ</span><span class="p">):</span> <span class="c1">#fitting of chi parametre only (not a1 parametre)</span>
            <span class="k">return</span><span class="p">(</span><span class="n">fit_polaS</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">chi_XXZ</span><span class="p">,</span> <span class="n">ai</span><span class="p">))</span>
    
        <span class="n">p_s</span><span class="p">,</span> <span class="n">q_s</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">helper_S</span><span class="p">,</span> <span class="n">L_angle_rad</span><span class="p">,</span> <span class="n">L_intensity_S</span><span class="p">)</span>
        <span class="n">XXZ</span> <span class="o">=</span> <span class="n">p_s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        
    <span class="n">chi_XXZ</span><span class="o">=</span><span class="n">XXZ</span>
    
    <span class="k">def</span> <span class="nf">helper_P</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">chi_ZXX</span><span class="p">,</span> <span class="n">chi_ZZZ</span><span class="p">):</span> <span class="c1">#fitting of ZXX and ZZZ chi parametres only (not a2,3,4,5 and XXZ parametres)</span>
        <span class="k">return</span> <span class="n">fit_polaP</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">chi_XXZ</span><span class="p">,</span> <span class="n">chi_ZXX</span><span class="p">,</span> <span class="n">chi_ZZZ</span><span class="p">,</span> <span class="n">ai</span><span class="p">)</span>
    
    <span class="n">p_p</span><span class="p">,</span> <span class="n">q_p</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">helper_P</span><span class="p">,</span> <span class="n">L_angle_rad</span><span class="p">,</span> <span class="n">L_intensity_P</span><span class="p">)</span>
    <span class="n">ZXX</span> <span class="o">=</span> <span class="n">p_p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ZZZ</span> <span class="o">=</span> <span class="n">p_p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    
    
    <span class="n">XXZset2</span><span class="o">=</span><span class="n">XXZ</span>
    <span class="n">ZXXset2</span><span class="o">=-</span><span class="n">ZXX</span>
    <span class="n">ZZZset2</span><span class="o">=</span><span class="p">(</span><span class="n">ai</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">XXZ</span><span class="o">/</span><span class="n">ai</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">+</span><span class="n">ZZZ</span><span class="p">)</span><span class="o">*-</span><span class="mi">1</span> <span class="c1">#ZZZ&#39;=-(2*a2*XXZ/a4+ZZZ)</span>
    
    <span class="n">list_chi</span> <span class="o">=</span> <span class="p">[</span><span class="n">XXZ</span><span class="p">,</span> <span class="n">ZXX</span><span class="p">,</span> <span class="n">ZZZ</span><span class="p">,</span> <span class="n">XXZset2</span><span class="p">,</span> <span class="n">ZXXset2</span><span class="p">,</span> <span class="n">ZZZset2</span><span class="p">]</span>
    
    <span class="k">return</span> <span class="p">(</span> <span class="n">ai</span><span class="p">,</span> <span class="n">list_chi</span><span class="p">)</span></div>
    
    
<span class="c1">############################################################################################ </span>
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/alpaga_logo.svg" alt="Logo"/>
            </a></p>
<h1 class="logo"><a href="../index.html">Alpaga</a></h1>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">1. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../file_management.html">2. File management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cleaning_averaging_spectra.html">3. Cleaning and Averaging Spectra</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fitting_procedure.html">4. Fitting the Gaussian</a></li>
<li class="toctree-l1"><a class="reference internal" href="../polarisation_procedure.html">5. Polarisation Procedure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis_SHS.html">6. SHS analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis_SSHG.html">7. SSHG analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python_advice.html">8. Python advice</a></li>
<li class="toctree-l1"><a class="reference internal" href="../experimental_advice.html">9. Experimental and procedure advice</a></li>
<li class="toctree-l1"><a class="reference internal" href="../for_developpers.html">10. For Developpers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../alpaga.html">11. Source code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../devs_page.html">12. Alpaga’s developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference.html">13. Reference</a></li>
</ul>


<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;L-GPL.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.3.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>