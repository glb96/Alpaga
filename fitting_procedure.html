<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>4. Fitting the Gaussian &#8212; Alpaga 1.2 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=27fed22d" />
    <script src="_static/documentation_options.js?v=61243dd2"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="5. Polarisation Procedure" href="polarisation_procedure.html" />
    <link rel="prev" title="3. Cleaning and Averaging Spectra" href="cleaning_averaging_spectra.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <blockquote>
<div></div></blockquote>
<section id="fitting-the-gaussian">
<span id="fitting-procedure-page"></span><h1><span class="section-number">4. </span>Fitting the Gaussian<a class="headerlink" href="#fitting-the-gaussian" title="Link to this heading">¶</a></h1>
<p>In this page, we will see how to extract the Gaussian intensity from a spectrum. This procedure has been optimised in order to get the less possible choice to the operator, and to make this part the most reproducible as possible. Indeed, small change in this procedure parameters can lead to variation of the extracted intensity. Therefore, there are many methods available: it is up to you to choose the one you prefer, and to document which one you have picked!</p>
<a class="reference internal image-reference" href="_images/alpaga_2.jpg"><img alt="_images/alpaga_2.jpg" class="align-right" src="_images/alpaga_2.jpg" style="width: 350px;" />
</a>
<p>First, the background around your Gaussian is most probably not flat. Indeed, due to fluorescence of your sample for instance, you can have a large noise which can make the Gaussian intensity extraction more difficult. Therefore, the first thing to do is to remove this noise.</p>
<p>Then, the extraction of the intensity can be made. Several methods, fit or integral, can be used.</p>
<p>In this page, it is assumed that the averaged and cleaned spectrum is given (called y value) as input as well as the wave number (called x values), see <a class="reference internal" href="cleaning_averaging_spectra.html#cleaning-averaging-spectra-page"><span class="std std-ref">Cleaning and Averaging Spectra</span></a> for more information. Note that the value and the unit of the x and y list does not matter for this analysis as long as the parameters respect the same unit and range.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If your curve is a Lorentzian, you can use the first step to get ride of the noise, then you will have to fit by yourself the intensity. Contact us if you want to implement this new fitting  procedure in Alpaga.</p>
</div>
<section id="remove-the-noise">
<h2><span class="section-number">4.1. </span>Remove the noise<a class="headerlink" href="#remove-the-noise" title="Link to this heading">¶</a></h2>
<a class="reference internal image-reference" href="_images/alpaga_10.jpg" id="remove-noise-section"><img alt="_images/alpaga_10.jpg" class="align-left" id="remove-noise-section" src="_images/alpaga_10.jpg" style="width: 300px;" />
</a>
<p>The spectra will be cut into 3 areas using the x values. The first area and the last one will be used in order to define the noise, while the second one should contain the Gaussian. The first and last area should be large enough in order to be fitted meaningfully by a polynomial function. If this ‘noise’ area is too large, the part where the Gaussian is located may not be properly fitted and thus modify the final intensity. If this noise area is too small, the noise fit can make no sense. A simple way to check if the area is too small is to add or remove one point to the noise area: the final Gaussian intensity should not be affected.</p>
<p>&#64;Antonin: je te laisse étoffer cette explication en rajoutant des figures?</p>
<p>For the order of the polynomial function  used to fit the noise, we recommend to use order 2, 3, or 4. We do not recommend to use less since the noise is often not a straight line. Higher term may work, but it can lead to wiggling in the Gaussian area.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the noise removal procedure has worked well, the first and last area should be flat and in average zero. The most important is that there is no curvature: otherwise the Gaussian fit below would return wrong value. If you struggle to have a flat first and last area, try to reduce them – for instance set the first and last area to 10 nm.</p>
</div>
<a class="reference internal image-reference" href="_images/gaussian_distribution_meme.png"><img alt="_images/gaussian_distribution_meme.png" class="align-right" src="_images/gaussian_distribution_meme.png" style="width: 200px;" />
</a>
</section>
<section id="gaussian-intensity-extraction">
<h2><span class="section-number">4.2. </span>Gaussian intensity extraction<a class="headerlink" href="#gaussian-intensity-extraction" title="Link to this heading">¶</a></h2>
<p id="gaussian-fit-section">Now that we have removed the background, the Gaussian spectra should be much easier to fit. There are two ways to extract the Gaussian intensity: by a function fit, or by an integral procedure.</p>
<ol class="arabic">
<li><p>Gaussian fit</p>
<blockquote>
<div><p>This method will fit the curve with a Gaussian function:</p>
<div class="math notranslate nohighlight">
\[f(x) = I_0 \exp \left[ - \left( \frac{ x - \lambda_0}{w_0} \right)^2 \right]\]</div>
<p>and return the intensity <span class="math notranslate nohighlight">\(I_0\)</span>, the position of the maximum <span class="math notranslate nohighlight">\(\lambda_0\)</span> and the waist <span class="math notranslate nohighlight">\(w_0\)</span>. This f(x) function is defined as the <em>alpaga.fit_gausse</em> function.</p>
</div></blockquote>
</li>
<li><dl>
<dt>Integral method</dt><dd><p>This method assumes that the position of the maximum and the waist is known, and extract the intensity using the value of the integral:</p>
<div class="math notranslate nohighlight">
\[f(x) = I_0 \exp \left[ - \left( \frac{ x - \lambda_0}{w_0} \right)^2 \right]
\int_{-\infty}^{+ \infty} f(x) dx = I_0 w_0 \sqrt \pi\]</div>
<p>The integral is performed in the <em>alpaga.intensity_from_gaussian_integral</em> function, and return the intensity.</p>
</dd>
</dl>
</li>
</ol>
<a class="reference internal image-reference" href="_images/alpaga_3.jpg"><img alt="_images/alpaga_3.jpg" class="align-center" src="_images/alpaga_3.jpg" style="width: 300px;" />
</a>
<p>The function alpaga.fit_gausse defines the gaussian described in the first method. It is not the function that perform the fit, see bellow, but the one that returns a gaussian value for given x and all the other gaussian parameters. You may use this function to check how the ‘’gaussian’’ intensity is defined in Alpaga.</p>
<p>And here is the function used to extract the intensity from the integral method:</p>
<p>The Gaussian fit is the more versatile method: it can give you the intensity, along with important information: the waist and the maximum position. However, since this method uses a fit through all the curve, it can have an error if the intensity is small.</p>
<p>On the other hand, the integral method seems more robust to extract the intensity, but it requires to know the waist. For ‘easy-to-fit Gaussian curve’, the two method return the same result. It is not clear which method is the most precise, therefore they are both always available.</p>
<p>The function to extract the Gaussian intensity uses the previous one, <em>alpaga.remove_noise</em>, to get ride of the noise. If you are working already with noise-free curve, this should not be a problem.</p>
</section>
<section id="towards-automating">
<h2><span class="section-number">4.3. </span>Towards automating<a class="headerlink" href="#towards-automating" title="Link to this heading">¶</a></h2>
<a class="reference internal image-reference" href="_images/alpaga_7.jpg"><img alt="_images/alpaga_7.jpg" class="align-right" src="_images/alpaga_7.jpg" style="width: 300px;" />
</a>
<p>The extraction of the intensity from the averaged spectra is maybe the part where the numerical parameters influence the more the result. Therefore, it is recommended to:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Try several parameters to see how it fits <strong>your</strong> data. Certain samples may be much easier to fit than others.</p></li>
<li><p>Use the <strong>same parameters</strong> for all your acquisition.</p></li>
</ol>
</div></blockquote>
<p>The full automatic procedure is presented in the ref:<span class="incremental">polarisation_procedure_page</span>. It combines what has been presented in <a class="reference internal" href="file_management.html#file-management-page"><span class="std std-ref">File management</span></a> , <a class="reference internal" href="cleaning_averaging_spectra.html#cleaning-averaging-spectra-page"><span class="std std-ref">Cleaning and Averaging Spectra</span></a> and in this page.</p>
<dl class="field-list simple">
<dt class="field-odd">Release<span class="colon">:</span></dt>
<dd class="field-odd"><p>1.2</p>
</dd>
<dt class="field-even">Date<span class="colon">:</span></dt>
<dd class="field-even"><p>Aug 22, 2025</p>
</dd>
</dl>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/alpaga_logo.svg" alt="Logo of Alpaga"/>
            </a></p>
<h1 class="logo"><a href="index.html">Alpaga</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">1. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="file_management.html">2. File management</a></li>
<li class="toctree-l1"><a class="reference internal" href="cleaning_averaging_spectra.html">3. Cleaning and Averaging Spectra</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">4. Fitting the Gaussian</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#remove-the-noise">4.1. Remove the noise</a></li>
<li class="toctree-l2"><a class="reference internal" href="#gaussian-intensity-extraction">4.2. Gaussian intensity extraction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#towards-automating">4.3. Towards automating</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="polarisation_procedure.html">5. Polarisation Procedure</a></li>
<li class="toctree-l1"><a class="reference internal" href="analysis_SHS.html">6. SHS analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="analysis_SSHG.html">7. SSHG analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="python_advice.html">8. Python advice</a></li>
<li class="toctree-l1"><a class="reference internal" href="experimental_advice.html">9. Experimental and procedure advice</a></li>
<li class="toctree-l1"><a class="reference internal" href="for_developpers.html">10. For Developpers</a></li>
<li class="toctree-l1"><a class="reference internal" href="alpaga.html">11. Source code</a></li>
<li class="toctree-l1"><a class="reference internal" href="devs_page.html">12. Alpaga’s developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference.html">13. Reference</a></li>
</ul>


<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;L-GPL.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="_sources/fitting_procedure.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>